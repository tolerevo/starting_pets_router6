{"ast":null,"code":"import cookieUtils from \"@bundled-es-modules/cookie\";\nimport { store } from \"@mswjs/cookies\";\nfunction getAllDocumentCookies() {\n  return cookieUtils.parse(document.cookie);\n}\nfunction getRequestCookies(request) {\n  if (typeof document === \"undefined\" || typeof location === \"undefined\") {\n    return {};\n  }\n  switch (request.credentials) {\n    case \"same-origin\":\n      {\n        const url = new URL(request.url);\n        return location.origin === url.origin ? getAllDocumentCookies() : {};\n      }\n    case \"include\":\n      {\n        return getAllDocumentCookies();\n      }\n    default:\n      {\n        return {};\n      }\n  }\n}\nfunction getAllRequestCookies(request) {\n  const requestCookiesString = request.headers.get(\"cookie\");\n  const cookiesFromHeaders = requestCookiesString ? cookieUtils.parse(requestCookiesString) : {};\n  store.hydrate();\n  const cookiesFromStore = Array.from(store.get(request)?.entries()).reduce((cookies, _ref) => {\n    let [name, {\n      value\n    }] = _ref;\n    return Object.assign(cookies, {\n      [name.trim()]: value\n    });\n  }, {});\n  const cookiesFromDocument = getRequestCookies(request);\n  const forwardedCookies = {\n    ...cookiesFromDocument,\n    ...cookiesFromStore\n  };\n  for (const [name, value] of Object.entries(forwardedCookies)) {\n    request.headers.append(\"cookie\", cookieUtils.serialize(name, value));\n  }\n  return {\n    ...forwardedCookies,\n    ...cookiesFromHeaders\n  };\n}\nexport { getAllRequestCookies, getRequestCookies };","map":{"version":3,"mappings":"AAAA,OAAOA,iBAAiB;AACxB,SAASC,aAAa;AAEtB,SAASC,wBAAwB;EAC/B,OAAOF,YAAYG,MAAMC,SAASC,MAAM;AAC1C;AAMO,SAASC,kBAAkBC,SAA0C;EAI1E,IAAI,OAAOH,aAAa,eAAe,OAAOI,aAAa,aAAa;IACtE,OAAO,CAAC;EACV;EAEA,QAAQD,QAAQE;IACd,KAAK;MAAe;QAClB,MAAMC,MAAM,IAAIC,IAAIJ,QAAQG,GAAG;QAI/B,OAAOF,SAASI,WAAWF,IAAIE,SAASV,sBAAsB,IAAI,CAAC;MACrE;IAEA,KAAK;MAAW;QAEd,OAAOA,sBAAsB;MAC/B;IAEA;MAAS;QACP,OAAO,CAAC;MACV;EACF;AACF;AAEO,SAASW,qBAAqBN,SAA0C;EAC7E,MAAMO,uBAAuBP,QAAQQ,QAAQC,IAAI,QAAQ;EACzD,MAAMC,qBAAqBH,uBACvBd,YAAYG,MAAMW,oBAAoB,IACtC,CAAC;EAELb,MAAMiB,QAAQ;EAEd,MAAMC,mBAAmBC,MAAMC,KAAKpB,MAAMe,IAAIT,OAAO,GAAGe,QAAQ,CAAC,EAAEC,OAEjE,CAACC,kBAA+B;IAAA,IAAtB,CAACC,MAAM;MAAEC;IAAM,CAAC;IAC1B,OAAOC,OAAOC,OAAOJ,SAAS;MAAE,CAACC,KAAKI,KAAK,CAAC,GAAGH;IAAM,CAAC;EACxD,GAAG,CAAC,CAAC;EAEL,MAAMI,sBAAsBxB,kBAAkBC,OAAO;EAErD,MAAMwB,mBAAmB;IACvB,GAAGD;IACH,GAAGX;EACL;EAQA,WAAW,CAACM,MAAMC,KAAK,KAAKC,OAAOL,QAAQS,gBAAgB,GAAG;IAC5DxB,QAAQQ,QAAQiB,OAAO,UAAUhC,YAAYiC,UAAUR,MAAMC,KAAK,CAAC;EACrE;EAEA,OAAO;IACL,GAAGK;IACH,GAAGd;EACL;AACF","names":["cookieUtils","store","getAllDocumentCookies","parse","document","cookie","getRequestCookies","request","location","credentials","url","URL","origin","getAllRequestCookies","requestCookiesString","headers","get","cookiesFromHeaders","hydrate","cookiesFromStore","Array","from","entries","reduce","cookies","name","value","Object","assign","trim","cookiesFromDocument","forwardedCookies","append","serialize"],"sources":["/Users/ditole/Desktop/projects/pets-store/node_modules/msw/src/core/utils/request/getRequestCookies.ts"],"sourcesContent":["import cookieUtils from '@bundled-es-modules/cookie'\nimport { store } from '@mswjs/cookies'\n\nfunction getAllDocumentCookies() {\n  return cookieUtils.parse(document.cookie)\n}\n\n/** @todo Rename this to \"getDocumentCookies\" */\n/**\n * Returns relevant document cookies based on the request `credentials` option.\n */\nexport function getRequestCookies(request: Request): Record<string, string> {\n  /**\n   * @note No cookies persist on the document in Node.js: no document.\n   */\n  if (typeof document === 'undefined' || typeof location === 'undefined') {\n    return {}\n  }\n\n  switch (request.credentials) {\n    case 'same-origin': {\n      const url = new URL(request.url)\n\n      // Return document cookies only when requested a resource\n      // from the same origin as the current document.\n      return location.origin === url.origin ? getAllDocumentCookies() : {}\n    }\n\n    case 'include': {\n      // Return all document cookies.\n      return getAllDocumentCookies()\n    }\n\n    default: {\n      return {}\n    }\n  }\n}\n\nexport function getAllRequestCookies(request: Request): Record<string, string> {\n  const requestCookiesString = request.headers.get('cookie')\n  const cookiesFromHeaders = requestCookiesString\n    ? cookieUtils.parse(requestCookiesString)\n    : {}\n\n  store.hydrate()\n\n  const cookiesFromStore = Array.from(store.get(request)?.entries()).reduce<\n    Record<string, string>\n  >((cookies, [name, { value }]) => {\n    return Object.assign(cookies, { [name.trim()]: value })\n  }, {})\n\n  const cookiesFromDocument = getRequestCookies(request)\n\n  const forwardedCookies = {\n    ...cookiesFromDocument,\n    ...cookiesFromStore,\n  }\n\n  // Set the inferred cookies from the cookie store and the document\n  // on the request's headers.\n  /**\n   * @todo Consider making this a separate step so this function\n   * is pure-er.\n   */\n  for (const [name, value] of Object.entries(forwardedCookies)) {\n    request.headers.append('cookie', cookieUtils.serialize(name, value))\n  }\n\n  return {\n    ...forwardedCookies,\n    ...cookiesFromHeaders,\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}